# Nano Keycloak

## About Keycloak
- [Official Site - EN](https://www.keycloak.org/)
- [Official Site - TW](https://keycloak.dev.org.tw/)

## Launch the Service
- For local testing, directly trigger the docker compose file:
  - `nano-gateway/nano-gateway-compose/keycloak/docker-compose-keycloak.yml`
- For docker-compose deployment, it will be adopted in:
  - `nano-gateway/nano-gateway-compose/docker-compose-main.yml`

## Endpoints
- Main entrypoint: 
  - https://127.0.0.1:8443
- Health check:
  - https://127.0.0.1:9000/health
  - https://127.0.0.1:9000/health/ready
  - https://127.0.0.1:9000/health/live
- Metrics:
  - https://127.0.0.1:9000/metrics 

## Detail Settings
- Configuration files
  - For local development: 
    - `nano-gateway/components/keycloak/conf/local/keycloak.conf`
  - For docker-compose deployment: 
    - `nano-gateway/components/keycloak/conf/compose/keycloak.conf`
- Keystore file for enabling the HTTPS protocol
  - `nano-gateway/components/keycloak/conf/nano_keycloak_key.keystore`
- The keystore file was generated by the following command:
```commandline
keytool -genkeypair -storepass admin123 -storetype PKCS12 -keyalg RSA -keysize 2048 -dname "C=TW,ST=Taiwan,L=Taipei,O=Nano Gateway Inc.,OU=Engineering Department,CN=wandrers.one" -alias nano_keycloak_key -ext "SAN:c=DNS:localhost,IP:127.0.0.1" -keystore keystore/nano_keycloak_key.keystore
```
- The keystore should be refreshed every 30 days, you can also perform the keytool command inside the Dockerfile which is only for testing purpose.   
